<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=EB+Garamond:wght@400&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'EB Garamond', serif;
            background-color: #2c2c2c;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
        .container {
            background-color: #444;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        label, select, input {
            display: block;
            margin: 10px 0;
        }
        button {
            padding: 10px 20px;
            border: none;
            background-color: #555;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #777;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Welcome to the Virtual Escape Room</h1>
        <form id="loginForm" action="/login" method="post">
            <label for="first_name">First Name:</label>
            <input type="text" id="first_name" name="first_name" required>
            
            <label for="last_initial">Last Initial:</label>
            <input type="text" id="last_initial" name="last_initial" maxlength="1" required>
            
            <label for="grade_level">Grade Level:</label>
            <select id="grade_level" name="grade_level" required>
                <option value="6th Grade">6th Grade</option>
                <option value="7th Grade">7th Grade</option>
                <option value="8th Grade">8th Grade</option>
            </select>
            
            <button id="loginButton" type="submit">Log In</button>
        </form>
    </div>
    <script>
    // Import Node.js modules
    const fs = require('fs');
    const path = require('path');
    const os = require('os');

    // Path to save the CSV file on the Desktop
    const desktopPath = path.join(os.homedir(), 'Desktop', 'T1.csv');

    // Event listener for the login button click
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        // Prevent form submission until data is saved
        event.preventDefault();
        
        // Collect form data
        let firstName = document.getElementById('first_name').value; 
        let lastInitial = document.getElementById('last_initial').value; 
        let gradeLevel = document.getElementById('grade_level').value; 
        let loginTimestamp = new Date().toISOString();
        
        // Generate a session ID based on user input
        let sessionID = `${firstName.charAt(0)}${lastInitial}${gradeLevel}${loginTimestamp}`;
        
        // Prepare the data to be saved in CSV format
        const loginData = `${sessionID},${firstName},${lastInitial},${gradeLevel},${loginTimestamp}\n`;

        // Save the data to the CSV file
        fs.appendFile(desktopPath, loginData, (err) => {
            if (err) {
                console.error('Error writing to CSV file:', err);
            } else {
                console.log('Login data successfully saved to T1.csv on the Desktop');
                // Once data is saved, proceed with form submission
                document.getElementById('loginForm').submit();
            }
        });
    });
    </script>
</body>
</html>
